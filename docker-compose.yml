version: '3.8'

services:
  web-api:
    build: ./api  # This is correct
    ports:
      - "8765:8000" # This is correct
    volumes:
      # 1. This gives the 'web-api' container permission to run 'docker' commands
      - /var/run/docker.sock:/var/run/docker.sock
      
      # 2. !! THIS IS THE CRITICAL FIX !!
      # This maps the host's /tmp directory to the container's /tmp directory.
      # Now, when Python creates /tmp/tmpXYZ, it exists on the host,
      # and the 'docker run' command will find it.
      - /tmp:/tmp

  # The 'converter' service you had here has been REMOVED.
  # It is not needed, as your Python code calls the gmsh image directly.